/*!
 * jAltoUploader.js
 * Файл jquery-плагина для аплоадера изображений Alto
 *
 * @author      Андрей Воронов <andreyv@gladcode.ru>
 * @copyrights  Copyright © 2014, Андрей Воронов
 * @version     0.0.1 от 08.11.2014 12:43
 */
(function(b){var a=function(d,c){this.$element=b(d);
this.blockButtons=false;this.options=b.extend({},b.fn.altoUploader.defaultOptions,c,this.$element.data());this.$image=this.$element.find("img.js-uploader-image");
this.$imageFull=this.$element.find("img.js-uploader-image-full");this.buttons={$upload:this.$element.find(".js-uploader-button-upload"),$remove:this.$element.find(".js-uploader-button-remove")};
if(this.options.crop=="yes"){this.$modal=b(this.options.selectors.cropModal);this.$cropImage=b(this.options.selectors.cropImage);this.jcropImage=null}this.$file=this.$element.find(".js-uploader-file");
this.init();return this.$element};a.prototype={init:function(){var c=this;c.$file.off("change").on("change",function(){c.uploadImage(this);return false
});c.buttons.$remove.off("click").on("click",function(){c.uploadImageRemove();return false});return c},uploadImage:function(c){var e=this;if(e.blockButtons){return e
}var d=b('<form method="post" enctype="multipart/form-data"/>').hide().appendTo("body");c=b(c);c.clone(true).insertAfter(c);c.removeAttr("id").appendTo(d);
b('<input type="hidden" name="target" value="'+e.options.target+'">').appendTo(d);b('<input type="hidden" name="target_id" value="'+e.options.targetId+'">').appendTo(d);
ls.progressStart();e.blockButtons=true;ls.hook.run("uploader_progress_start",[e.options]);ls.ajaxSubmit(e.options.url.upload,d,function(f){ls.progressDone();
e.blockButtons=false;ls.hook.run("uploader_progress_stop",[e.options]);if(!f){ls.msg.error(null,"System error #1001")}else{if(f.bStateError){ls.msg.error(f.sMsgTitle,f.sMsg)
}else{if(e.options.crop=="yes"){e.uploadImageModalCrop(f.sPreview)}else{e.uploadDirect()}}}d.remove()},{progress:true});return e},uploadDirect:function(){var c=this;
if(c.blockButtons){return c}ls.progressStart();c.blockButtons=true;ls.hook.run("uploader_progress_start",[c.options]);ls.ajax(c.options.url.direct,{target:c.options.target,target_id:c.options.targetId,crop_size:c.options.previewCrop},function(d){ls.progressDone();
c.blockButtons=false;ls.hook.run("uploader_progress_stop",[c.options]);if(!d){ls.msg.error(null,"System error #1001")}else{if(d.bStateError){ls.msg.error(null,d.sMsg)
}else{c.$image.attr("src",d.sFilePreview+"?"+Math.random());if(c.$imageFull.length>0){c.$imageFull.attr("src",d.sFile+"?"+Math.random())}c.buttons.$remove.css({display:"block"});
ls.hook.run("uploader_upload_image_after",[c.options,d])}}});return this},uploadImageRemove:function(){var c=this;if(c.blockButtons){return c}ls.progressStart();
c.blockButtons=true;ls.hook.run("uploader_progress_start",[c.options]);ls.ajax(c.options.url.remove,{target:c.options.target,target_id:c.options.targetId},function(d){ls.progressDone();
c.blockButtons=false;ls.hook.run("uploader_progress_stop",[c.options]);if(!d){ls.msg.error(null,"System error #1001")}else{if(d.bStateError){ls.msg.error(null,d.sMsg)
}else{c.$image.attr("src",c.options.empty+"?"+Math.random());c.buttons.$remove.css({display:"none"});ls.hook.run("uploader_remove_image_after",[c.options,d])
}}});return c},uploadImageModalCrop:function(c){var d=this;if(typeof d.options.title!=="undefined"){d.$modal.find(".modal-title").text(ls.lang.get(d.options.title))
}if(typeof d.options.help!=="undefined"){d.$modal.find(".js-crop_img-help").text(ls.lang.get(d.options.help))}d.$modal.modal("show");d.$modal.find(".js-confirm").off("click").on("click",function(){d.uploadImageCropSubmit(this);
return false});d.$modal.find(".js-cancel").off("click").on("click",function(){d.uploadImageCropCancel(this);return false});b(d.$cropImage).attr("src",c+"?"+Math.random()).css({width:"auto",height:"auto"});
d.uploadImageCropInit(d.$cropImage);return d},uploadImageCropInit:function(d){var c=this;this.uploadImageCropDone();b(d).Jcrop(c.options.cropOptions,function(){c.jcropImage=this
});return c},uploadImageCropDone:function(){var c=this;if(c.jcropImage){c.jcropImage.release();c.jcropImage.destroy()}return c},uploadImageCropSubmit:function(c){var d=this;
if(d.blockButtons){return d}c=b(c);var e={size:d.jcropImage.tellSelect(),crop_size:d.options.previewCrop};c.addClass("loading");ls.progressStart();d.blockButtons=true;
ls.hook.run("uploader_progress_start",[d.options]);ls.ajax(d.options.url.crop,e,function(f){ls.progressDone();d.blockButtons=false;ls.hook.run("uploader_progress_stop",[d.options]);
if(!f){ls.msg.error(null,"System error #1001")}else{if(f.bStateError){ls.msg.error(null,f.sMsg)}else{d.$image.attr("src",f.sFilePreview+"?"+Math.random());
if(d.$imageFull.length>0){d.$imageFull.attr("src",f.sFile+"?"+Math.random())}d.$modal.modal("hide");d.buttons.$remove.css({display:"block"});ls.hook.run("uploader_upload_image_after",[d.options,f])
}}c.removeClass("loading")});return d},uploadImageCropCancel:function(c){var d=this;if(d.blockButtons){return d}c=b(c);c.addClass("loading");ls.progressStart();
d.blockButtons=true;ls.hook.run("uploader_progress_start",[d.options]);ls.ajax(d.options.url.cancel,{target:d.options.target,target_id:d.options.targetId},function(e){ls.progressDone();
d.blockButtons=false;ls.hook.run("uploader_progress_stop",[d.options]);if(!e){ls.msg.error(null,"System error #1001")}else{if(e.bStateError){ls.msg.error(null,e.sMsg)
}else{d.$modal.modal("hide");ls.hook.run("ls_uploader_cancel_after",[e])}}c.removeClass("loading")});return d}};b.fn.altoUploader=function(c){return this.each(function(){var f=b(this);
var e=f.data("alto.altoUploader");var d=typeof c==="object"&&c;if(!e){f.data("alto.altoUploader",(e=new a(this,d)))}if(typeof c==="string"){e[c]()}return f
})};b.fn.altoUploader.Constructor=a;b.fn.altoUploader.defaultOptions={cropOptions:{minSize:[32,32],setSelect:[0,0,800,800]},selectors:{cropModal:"#modal-crop_img",cropImage:".js-crop_img"},url:{upload:ls.routerUrl("uploader")+"upload-image/",remove:ls.routerUrl("uploader")+"remove-image/",cancel:ls.routerUrl("uploader")+"cancel-image/",crop:ls.routerUrl("uploader")+"resize-image/",direct:ls.routerUrl("uploader")+"direct-image/"}}
}(window.jQuery));$(function(){$(".js-alto-uploader").altoUploader({hello:"world"})});/*!
 * blogBrandingPanel.js
 * Файл скриптов плагина branding
 *
 * @author      Андрей Воронов <andreyv@gladcode.ru>
 * @copyrights  Copyright © 2014, Андрей Воронов
 *              Является частью плагина branding
 * @version     0.0.1 от 09.11.2014 11:53
 */
(function(a){var b=function(d,c){this.$element=a(d);
this.blockButtons=false;this.options=a.extend({},a.fn.blogBrandingPanel.defaultOptions,c,this.$element.data());this.$image=this.$element.find("img.js-branding-blog-background");
this.$slider=this.$element.find(".js-branding-blog-opacity-slider");this.$headerSlider=this.$element.find(".js-branding-blog-header-step-slider");this.$sliderLabel=this.$element.find(".js-branding-blog-opacity-slider-label");
this.$headerSliderLabel=this.$element.find(".js-branding-blog-header-step-label");this.$colorLabel=this.$element.find(".js-branding-blog-color-slider-label");
this.$loader=this.$element.find(".js-branding-blog-loader");this.$styles=a("#plugin-branding-blog-styles");this.$backgroundPicker=a("#blog-background-color-picker");
this.$fontColorPicker=a("#blog-font-color-picker");this.$headerColorPicker=a("#blog-header-color-picker");this.$buttonColorOnly=a(".js-blog-branding-color-only");
this.$buttonBoth=a(".js-blog-branding-both");this.$buttonRemove=a(".js-uploader-button-remove");this.$buttonUpload=a(".js-uploader-button-upload");this.$buttonSave=a(".js-blog-save-branding");
this.$buttonDelete=a(".js-blog-delete-branding");this.$file=a("#blog-photo-file");this.$backgroundType=a(".js-uploader-blog-type");this.init();return this.$element
};b.prototype={init:function(){var c=this;c.$buttonDelete.tooltip();c.$buttonDelete.hover(function(){c.$buttonSave.hide()},function(){c.$buttonSave.show()
});c.$buttonDelete.on("shown.bs.tooltip",function(){c.$buttonSave.hide()});c.$buttonDelete.on("hidden.bs.tooltip",function(){c.$buttonSave.show()});c.$buttonDelete.on("click",function(){if(c.blockButtons){return c
}ls.progressStart();c.showLoader(true);c.blockButtons=true;ls.ajax(c.options.url.remove,{options:c.options},function(d){ls.progressDone();c.hideLoader(true);
c.blockButtons=false;c.$buttonDelete.hide();c.options.brandingBackground="";c.options.brandingBackgroundType="";c.options.brandingHeaderStep=0;c.options.brandingHas=false;
c.options.brandingOpacity=100;c.options.brandingUseBackgroundColor=false;c.options.brandingBackgroundColor="#FFFFFF";c.options.brandingFontColor="#000000";
c.options.brandingHeaderColor="#000000";c.formCss();c.$headerSlider.val(c.options.brandingHeaderStep).change();c.$image.attr("src",a(".js-alto-uploader").data("empty"));
c.$backgroundType.show();c.$backgroundType.selecter("enable",0);c.$backgroundType.find("[value='0']").attr("selected","selected");c.$backgroundType.parent().find(".selecter-selected").text(c.$backgroundType.find("[value='0']").text());
c.$backgroundType.selecter("refresh");c.$buttonRemove.fadeOut(0);c.$buttonUpload.fadeIn(0);c.$backgroundType.parents(".uploader-blog-type").fadeIn(0);c.$buttonColorOnly.fadeIn(0);
c.$buttonBoth.fadeOut(0);c.$file.fadeIn(0);c.$image.css("opacity",1);c.$slider.val(100).change();c.$sliderLabel.text("100%");c.$backgroundPicker.val(c.options.brandingBackgroundColor).css({"background-color":"#FFFFFF"}).css({color:jQuery.Color("#FFFFFF").contrastColor()});
c.$fontColorPicker.val(c.options.brandingFontColor).css({"background-color":"#000000"}).css({color:jQuery.Color("#000000").contrastColor()});c.$headerColorPicker.val(c.options.brandingHeaderColor).css({color:jQuery.Color("#000000").contrastColor()}).css({"background-color":"#000000"});
if(!d){ls.msg.error(null,"System error #1001")}else{ls.msg.notice(null,ls.lang.get(c.options.langBlogBrandingRemoved))}})});jQuery.Color.fn.contrastColor=function(){var f=this._rgba[0],e=this._rgba[1],d=this._rgba[2];
return(((f*299)+(e*587)+(d*144))/1000)>=131.5?"#333333":"#ffffff"};c.$backgroundType.on("change",function(){c.options.brandingBackgroundType=c.$backgroundType.val();
c.formCss()});c.$buttonColorOnly.on("click",function(){c.options.brandingUseBackgroundColor=true;c.$buttonRemove.fadeOut(0);c.$buttonUpload.fadeOut(0);
c.$backgroundType.parents(".uploader-blog-type").fadeOut(0);c.$buttonColorOnly.fadeOut(0);c.$buttonBoth.fadeIn(0);c.$file.css("top",-10000);c.$image.css("opacity",0);
c.formCss()});c.$buttonBoth.on("click",function(){c.options.brandingUseBackgroundColor=false;c.$buttonUpload.fadeIn(0);if(c.options.brandingBackground){c.$buttonRemove.fadeIn(0)
}c.$backgroundType.parents(".uploader-blog-type").fadeIn(0);c.$buttonColorOnly.fadeIn(0);c.$buttonBoth.fadeOut(0);c.$file.css("top",0);c.$file.css("display","block");
c.$image.css("opacity",1);c.formCss()});c.$buttonSave.on("click",function(){c.saveBranding()});ls.hook.add("uploader_upload_image_after",function(e,d){if(e.target=="blog-branding"||e.target=="topic-branding"||e.target=="user-branding"){var f=a("body");
c.options.brandingBackground=d.sFile;c.formCss();c.$image.css({"background-color":c.getBackgroundColor()});c.$image.parent().css({"background-color":c.getBackgroundColor()});
ls.msg.notice(null,ls.lang.get(c.options.langBlogImageLoadingGood))}});ls.hook.add("uploader_remove_image_after",function(e,d){if(e.target=="blog-branding"||e.target=="topic-branding"||e.target=="user-branding"){c.options.brandingBackground=d.sFile;
c.formCss();ls.msg.notice(null,ls.lang.get(c.options.langBlogImageLoadingRevert))}});ls.hook.add("color_picker_after_select",function(d,e){e.$input.css({color:jQuery.Color(d).contrastColor()});
if(e.$input.attr("id")=="blog-background-color-picker"){c.options.brandingBackgroundColor=d}if(e.$input.attr("id")=="blog-font-color-picker"){c.options.brandingFontColor=d
}if(e.$input.attr("id")=="blog-header-color-picker"){c.options.brandingHeaderColor=d}c.formCss()});ls.hook.add("color_picker_after_move",function(d,e){e.$input.css({color:jQuery.Color(d).contrastColor()});
if(e.$input.attr("id")=="blog-background-color-picker"){c.options.brandingBackgroundColor=d;c.$image.css({"background-color":c.getBackgroundColor()});c.$image.parent().css({"background-color":c.getBackgroundColor()})
}if(e.$input.attr("id")=="blog-font-color-picker"){c.options.brandingFontColor=d;a(".topic-text").add(".topic").add("input, select *, textarea").add(".input-group *").add(".selecter *").not("h1, h2, h3, h4, h5, h6").not(".branding-panel *").css({color:c.options.brandingFontColor})
}if(e.$input.attr("id")=="blog-header-color-picker"){c.options.brandingHeaderColor=d;a(".container.content  h1, .container.content  h2, .container.content  h3, .container.content  h4, .container.content  h5, .container.content  h6").css({color:c.options.brandingHeaderColor})
}});ls.hook.add("uploader_progress_start",function(d){if(d.target=="blog-branding"){c.showLoader(false)}});ls.hook.add("uploader_progress_stop",function(d){if(d.target=="blog-branding"){c.hideLoader(false)
}});c.$backgroundPicker.colorPicker();c.$fontColorPicker.colorPicker();c.$headerColorPicker.colorPicker();c.$slider.rangeslider({polyfill:false,rangeClass:"rangeslider",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",onInit:function(){c.$slider.val(c.options.brandingOpacity).change()
},onSlide:function(d,e){c.$sliderLabel.text(e+"%");c.options.brandingOpacity=e;c.$image.css({"background-color":c.getBackgroundColor()});c.$image.parent().css({"background-color":c.getBackgroundColor()})
},onSlideEnd:function(d,e){c.options.brandingOpacity=e;c.formCss()}});c.$headerSlider.rangeslider({polyfill:false,rangeClass:"rangeslider",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",onInit:function(){c.$headerSlider.val(c.options.brandingHeaderStep).change()
},onSlide:function(d,e){c.$headerSliderLabel.text(e+"px");c.options.brandingHeaderStep=e},onSlideEnd:function(d,e){c.options.brandingHeaderStep=e;c.formCss()
}});c.setDefaultValues();return c},saveBranding:function(){var c=this;if(c.blockButtons){return c}ls.progressStart();c.showLoader();c.blockButtons=true;
ls.ajax(c.options.url.save,{options:c.options},function(d){ls.progressDone();c.hideLoader();c.blockButtons=false;c.options.brandingHas=true;c.$buttonDelete.show();
if(!d){ls.msg.error(null,"System error #1001")}else{ls.msg.notice(null,ls.lang.get(c.options.langBlogOpacityLoadingGood))}})},setDefaultValues:function(){var c=this;
c.$backgroundPicker.css({backgroundColor:c.options.brandingBackgroundColor,color:jQuery.Color(c.options.brandingBackgroundColor).contrastColor()}).val(c.options.brandingBackgroundColor);
c.$colorLabel.text(c.options.brandingBackgroundColor);c.$image.css({"background-color":c.getBackgroundColor()});c.$image.parent().css({"background-color":c.getBackgroundColor()});
if(c.options.brandingUseBackgroundColor){c.$image.css("opacity",0);c.$file.fadeOut(0)}else{c.$image.css("opacity",1);c.$file.fadeIn(1)}if(c.options.brandingFontColor){c.$fontColorPicker.css({backgroundColor:c.options.brandingFontColor,color:jQuery.Color(c.options.brandingFontColor).contrastColor()}).val(c.options.brandingFontColor)
}if(c.options.brandingHeaderColor){c.$headerColorPicker.css({backgroundColor:c.options.brandingHeaderColor,color:jQuery.Color(c.options.brandingHeaderColor).contrastColor()}).val(c.options.brandingHeaderColor)
}return c},showLoader:function(c){this.$loader.addClass("fa-spin").fadeIn(100);if(c==true){this.$buttonDelete.find("i").removeClass("fa-times").addClass("fa-spinner").addClass("fa-spin")
}if(c!=false){this.$buttonSave.find("i").removeClass("fa-upload").addClass("fa-spinner").addClass("fa-spin")}},hideLoader:function(c){this.$loader.removeClass("fa-spin").fadeOut(100);
if(c==true){this.$buttonDelete.find("i").addClass("fa-times").removeClass("fa-spinner").removeClass("fa-spin")}if(c!=false){this.$buttonSave.find("i").addClass("fa-upload").removeClass("fa-spinner").removeClass("fa-spin")
}},formCss:function(){var g=this;if(g.options.brandingHas==false){g.$styles.remove();g.$styles=a('<div id="plugin-branding-blog-styles"><style></style></div>');
g.$styles.appendTo("body");return}var d={};var e={};var h={h1:false,h2:false,h3:false,h4:false,h5:false,h6:false};var f="body { ";if(!g.options.brandingUseBackgroundColor){if(typeof g.options.brandingBackground==="undefined"||g.options.brandingBackground==""){}else{f+='background-image: url("'+g.options.brandingBackground+"?"+Math.random()+'"); '
}}else{}if(g.options.brandingBackgroundColor){f+="background-color: "+g.getBackgroundColor()+";"}if(g.options.brandingBackgroundType!=0){f+="background-repeat: no-repeat;";
var c=false;var i=false;if(g.options.brandingBackgroundType==1||g.options.brandingBackgroundType==2||g.options.brandingBackgroundType==3){i=g.options.themeBackgroundTopPadding
}if(g.options.brandingBackgroundType==5||g.options.brandingBackgroundType==6||g.options.brandingBackgroundType==7){i="100%"}if(g.options.brandingBackgroundType==4){i="50%"
}if(g.options.brandingBackgroundType==1||g.options.brandingBackgroundType==5){c="50%"}if(g.options.brandingBackgroundType==2||g.options.brandingBackgroundType==6){c="0"
}if(g.options.brandingBackgroundType==3||g.options.brandingBackgroundType==7){c="100%"}if(g.options.brandingBackgroundType==4){c="50%"}if(c&&i){f+="background-position: "+c+" "+i+";"
}if(g.options.brandingBackgroundType==8){f+="background-size: 100%; -moz-background-size: 100%; -webkit-background-size: 100%; -o-background-size: 100%;"
}}if(g.options.brandingFontColor){f+="color: "+g.options.brandingFontColor+"; "}f+="} ";if(g.options.brandingHeaderColor){f+=" h1, h1 * { color: "+g.options.brandingHeaderColor+"; }";
f+=" h2, h2 * { color: "+g.options.brandingHeaderColor+"; }";f+=" h3, h3 * { color: "+g.options.brandingHeaderColor+"; }";f+=" h4, h4 * { color: "+g.options.brandingHeaderColor+"; }";
f+=" h5, h5 * { color: "+g.options.brandingHeaderColor+"; }";f+=" h6, h6 * { color: "+g.options.brandingHeaderColor+"; }"}if(g.options.brandingHeaderStep){f+=" "+g.options.contentSelector+"{ position: relative; top: "+g.options.brandingHeaderStep+"px; }";
f+=" .footer-container { position: relative; top: "+g.options.brandingHeaderStep+"px; }"}else{f+=" "+g.options.contentSelector+"{ position: inherit; top: 0px; }";
f+=" .footer-container { position: inherit; top: 0px; }"}g.$styles.remove();g.$styles=a('<div id="plugin-branding-blog-styles"><style>'+f+"</style></div>");
g.$styles.appendTo("body");return g},getBackgroundColor:function(){var c=this;return"rgba("+c.hexToR(c.options.brandingBackgroundColor)+", "+c.hexToG(c.options.brandingBackgroundColor)+", "+c.hexToB(c.options.brandingBackgroundColor)+", "+(c.options.brandingOpacity/100).toString()+")"
},hexToR:function(c){return parseInt((this.cutHex(c)).substring(0,2),16)},hexToG:function(c){return parseInt((this.cutHex(c)).substring(2,4),16)},hexToB:function(c){return parseInt((this.cutHex(c)).substring(4,6),16)
},cutHex:function(c){return(c.charAt(0)=="#")?c.substring(1,7):c}};a.fn.blogBrandingPanel=function(c){return this.each(function(){var f=a(this);var e=f.data("alto.blogBrandingPanel");
var d=typeof c==="object"&&c;if(!e){f.data("alto.blogBrandingPanel",(e=new b(this,d)))}if(typeof c==="string"){e[c]()}return f})};a.fn.blogBrandingPanel.Constructor=b;
a.fn.blogBrandingPanel.defaultOptions={url:{save:ls.routerUrl("ajax")+"branding-save-blog/",remove:ls.routerUrl("ajax")+"branding-remove-blog/"}}}(window.jQuery));
$(function(){$(".js-branding-blog-panel").blogBrandingPanel({hello:"world"})});/*!
 * ColorPicker, https://github.com/ddaghan/ColorPicker, under MIT License
 */
;$.fn.colorPicker=function(){$(document).mouseup(function(){$(".colorPickerPane").remove()
});return this.each(function(){$(this).mouseup(function(h){h.stopPropagation();$(".colorPickerPane").remove();var n='<div class="colorPickerPane">                    <div class="HueSaturationWrapper">                        <img  data-toggle="tooltip" data-placement="bottom" title="'+f()+'" class="HueSaturation thumbnail" src="'+$(".js-branding-panel").data("palette")+'"/>				</div				>				<input class="Lightness  vertical" type="range" name="points" min="0" max="100" orient="vertical"/>			</div>';
var o=$(n);var i=o[0];i.$input=$(this);i.input=this;i.$Lightness=$(".Lightness",i);i.Lightness=i.$Lightness[0];i.Hue={value:255};i.Saturation={value:255};
i.$HueSaturation=$(".HueSaturation",i);i.HueSaturation=i.$HueSaturation[0];i.HueSaturation.colorPicker=i;i.$input.attr("spellcheck",false);var k=i.input.value;
if(e(k)){var m=d(k);var j=c(m[0],m[1],m[2]);i.Lightness.value=j[2]}else{i.Lightness.value=50}i.setHueSaturationColors=function(){var q=this.Lightness.value;
$(".HueSaturationWrapper").css("background-color",(q>50)?"white":"black");var p=1-Math.abs(q-50)/50;$(".HueSaturation").css("opacity",p)};i.toInput=function(){var r=this;
var q=parseInt(r.Lightness.value);var v=parseInt(r.Hue.value);var u=parseInt(r.Saturation.value);var w=a(v,u,q);var s=w[0];var t=w[1];var x=w[2];var p="#"+(16777216+s*65536+t*256+x).toString(16).substr(1);
r.input.style.backgroundColor=p;r.input.value=p;ls.hook.run("color_picker_after_move",[p,r])};i.$HueSaturation.load(function(){this.width=$(this).width();
this.height=$(this).height();this.offset=$(this).offset()});i.$Lightness.on("mousemove change",function(){i.setHueSaturationColors();i.toInput()});i.$input.on("blur",function(){var p=jQuery.Color($(this).val()).toHexString();
ls.hook.run("color_picker_after_select",[p,i]);i.$input.css({backgroundColor:p});i.$input.value=p;o.remove()});i.$input.on("change",function(){var p=jQuery.Color($(this).val()).toHexString();
ls.hook.run("color_picker_after_select",[p,i]);i.$input.css({backgroundColor:p});i.$input.value=p;o.remove()});i.$HueSaturation.bind("mousewheel DOMMouseScroll",function(r){var q=this.colorPicker;
r.preventDefault();var p=r.originalEvent.wheelDelta>0||r.originalEvent.detail<0;if(p){q.Lightness.value=q.Lightness.value*1+5}else{q.Lightness.value=q.Lightness.value-5
}q.setHueSaturationColors();q.toInput()});i.$HueSaturation.on("dragstart",function(p){p.preventDefault()});i.$HueSaturation.mousemove(function(s){var p=this.colorPicker;
var r=(s.pageX-(this.offset.left+1))/this.width;var q=1-(s.pageY-this.offset.top)/this.height;p.Hue.value=Math.floor(r*360);p.Saturation.value=Math.floor(q*100);
p.toInput()});i.$HueSaturation.mouseup(function(){ls.hook.run("color_picker_after_select",[i.input.value,i]);o.remove()});i.$Lightness.mouseup(function(p){p.stopPropagation()
});var l=i.$input.parent().offset();var g=i.$input.outerHeight(true);o.css({top:l.top+g,left:l.left});$("body").append(o);$(".colorPickerPane img").tooltip();
i.setHueSaturationColors()});function f(){return ls.lang.get("plugin.br.scroll_to_intensive")}function e(g){return g.match(/^\#[\dA-Fa-f]{6}$/)}function d(h){var j=parseInt(h.substr(1,2),16);
var i=parseInt(h.substr(3,2),16);var g=parseInt(h.substr(5,2),16);return[j,i,g]}function b(i,h,g){if(g<0){g+=1}if(g>1){g-=1}if(g<1/6){return i+(h-i)*6*g
}if(g<1/2){return h}if(g<2/3){return i+(h-i)*(2/3-g)*6}return i}function a(m,k,j){m/=360;k/=100;j/=100;var o,n,i;if(k==0){o=n=i=j}else{var t=j<0.5?j*(1+k):j+k-j*k;
var u=2*j-t;o=b(u,t,m+1/3);n=b(u,t,m);i=b(u,t,m-1/3)}return[Math.round(o*255),Math.round(n*255),Math.round(i*255)]}function c(i,n,p){i/=255,n/=255,p/=255;
var q=Math.max(i,n,p),k=Math.min(i,n,p);var m,t,j=(q+k)/2;if(q==k){m=t=0}else{var o=q-k;t=j>0.5?o/(2-q-k):o/(q+k);switch(q){case i:m=(n-p)/o+(n<p?6:0);
break;case n:m=(p-i)/o+2;break;case p:m=(i-n)/o+4;break}m/=6}return[Math.round(m*360),Math.round(t*100),Math.round(j*100)]}})};/*!
 * jQuery Color Animations v@VERSION
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: @DATE
 */
(function(o,d){var k="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",h=/^([\-+])=\s*(\d+\.?\d*)/,g=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(p){return[p[1],p[2],p[3],p[4]]
}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(p){return[p[1]*2.55,p[2]*2.55,p[3]*2.55,p[4]]
}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(p){return[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(p){return[parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16),parseInt(p[3]+p[3],16)]
}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(p){return[p[1],p[2]/100,p[3]/100,p[4]]
}}],e=o.Color=function(q,r,p,s){return new o.Color.fn.parse(q,r,p,s)},j={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},n={"byte":{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},m=e.support={},b=o("<p>")[0],a,l=o.each;
b.style.cssText="background-color:rgba(1,1,1,.5)";m.rgba=b.style.backgroundColor.indexOf("rgba")>-1;l(j,function(p,q){q.cache="_"+p;q.props.alpha={idx:3,type:"percent",def:1}
});function i(q,s,r){var p=n[s.type]||{};if(q==null){return(r||!s.def)?null:s.def}q=p.floor?~~q:parseFloat(q);if(isNaN(q)){return s.def}if(p.mod){return(q+p.mod)%p.mod
}return 0>q?0:p.max<q?p.max:q}function f(p){var r=e(),q=r._rgba=[];p=p.toLowerCase();l(g,function(w,x){var u,v=x.re.exec(p),t=v&&x.parse(v),s=x.space||"rgba";
if(t){u=r[s](t);r[j[s].cache]=u[j[s].cache];q=r._rgba=u._rgba;return false}});if(q.length){if(q.join()==="0,0,0,0"){o.extend(q,a.transparent)}return r}return a[p]
}e.fn=o.extend(e.prototype,{parse:function(v,t,p,u){if(v===d){this._rgba=[null,null,null,null];return this}if(v.jquery||v.nodeType){v=o(v).css(t);t=d}var s=this,r=o.type(v),q=this._rgba=[];
if(t!==d){v=[v,t,p,u];r="array"}if(r==="string"){return this.parse(f(v)||a._default)}if(r==="array"){l(j.rgba.props,function(w,x){q[x.idx]=i(v[x.idx],x)
});return this}if(r==="object"){if(v instanceof e){l(j,function(w,x){if(v[x.cache]){s[x.cache]=v[x.cache].slice()}})}else{l(j,function(x,y){var w=y.cache;
l(y.props,function(z,A){if(!s[w]&&y.to){if(z==="alpha"||v[z]==null){return}s[w]=y.to(s._rgba)}s[w][A.idx]=i(v[z],A,true)});if(s[w]&&o.inArray(null,s[w].slice(0,3))<0){s[w][3]=1;
if(y.from){s._rgba=y.from(s[w])}}})}return this}},is:function(r){var p=e(r),s=true,q=this;l(j,function(t,v){var w,u=p[v.cache];if(u){w=q[v.cache]||v.to&&v.to(q._rgba)||[];
l(v.props,function(x,y){if(u[y.idx]!=null){s=(u[y.idx]===w[y.idx]);return s}})}return s});return s},_space:function(){var p=[],q=this;l(j,function(r,s){if(q[s.cache]){p.push(r)
}});return p.pop()},transition:function(q,w){var r=e(q),s=r._space(),t=j[s],u=this.alpha()===0?e("transparent"):this,v=u[t.cache]||t.to(u._rgba),p=v.slice();
r=r[t.cache];l(t.props,function(A,C){var z=C.idx,y=v[z],x=r[z],B=n[C.type]||{};if(x===null){return}if(y===null){p[z]=x}else{if(B.mod){if(x-y>B.mod/2){y+=B.mod
}else{if(y-x>B.mod/2){y-=B.mod}}}p[z]=i((x-y)*w+y,C)}});return this[s](p)},blend:function(s){if(this._rgba[3]===1){return this}var r=this._rgba.slice(),q=r.pop(),p=e(s)._rgba;
return e(o.map(r,function(t,u){return(1-q)*p[u]+q*t}))},toRgbaString:function(){var q="rgba(",p=o.map(this._rgba,function(r,s){return r==null?(s>2?1:0):r
});if(p[3]===1){p.pop();q="rgb("}return q+p.join()+")"},toHslaString:function(){var q="hsla(",p=o.map(this.hsla(),function(r,s){if(r==null){r=s>2?1:0}if(s&&s<3){r=Math.round(r*100)+"%"
}return r});if(p[3]===1){p.pop();q="hsl("}return q+p.join()+")"},toHexString:function(p){var q=this._rgba.slice(),r=q.pop();if(p){q.push(~~(r*255))}return"#"+o.map(q,function(s){s=(s||0).toString(16);
return s.length===1?"0"+s:s}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});e.fn.parse.prototype=e.fn;function c(t,s,r){r=(r+1)%1;
if(r*6<1){return t+(s-t)*r*6}if(r*2<1){return s}if(r*3<2){return t+(s-t)*((2/3)-r)*6}return t}j.hsla.to=function(t){if(t[0]==null||t[1]==null||t[2]==null){return[null,null,null,t[3]]
}var p=t[0]/255,w=t[1]/255,x=t[2]/255,z=t[3],y=Math.max(p,w,x),u=Math.min(p,w,x),A=y-u,B=y+u,q=B*0.5,v,C;if(u===y){v=0}else{if(p===y){v=(60*(w-x)/A)+360
}else{if(w===y){v=(60*(x-p)/A)+120}else{v=(60*(p-w)/A)+240}}}if(A===0){C=0}else{if(q<=0.5){C=A/B}else{C=A/(2-B)}}return[Math.round(v)%360,C,q,z==null?1:z]
};j.hsla.from=function(w){if(w[0]==null||w[1]==null||w[2]==null){return[null,null,null,w[3]]}var v=w[0]/360,u=w[1],t=w[2],r=w[3],x=t<=0.5?t*(1+u):t+u-t*u,y=2*t-x;
return[Math.round(c(y,x,v+(1/3))*255),Math.round(c(y,x,v)*255),Math.round(c(y,x,v-(1/3))*255),r]};l(j,function(q,s){var r=s.props,p=s.cache,u=s.to,t=s.from;
e.fn[q]=function(z){if(u&&!this[p]){this[p]=u(this._rgba)}if(z===d){return this[p].slice()}var w,y=o.type(z),v=(y==="array"||y==="object")?z:arguments,x=this[p].slice();
l(r,function(A,C){var B=v[y==="object"?A:C.idx];if(B==null){B=x[C.idx]}x[C.idx]=i(B,C)});if(t){w=e(t(x));w[p]=x;return w}else{return e(x)}};l(r,function(v,w){if(e.fn[v]){return
}e.fn[v]=function(A){var C=o.type(A),z=(v==="alpha"?(this._hsla?"hsla":"rgba"):q),y=this[z](),B=y[w.idx],x;if(C==="undefined"){return B}if(C==="function"){A=A.call(this,B);
C=o.type(A)}if(A==null&&w.empty){return this}if(C==="string"){x=h.exec(A);if(x){A=B+parseFloat(x[2])*(x[1]==="+"?1:-1)}}y[w.idx]=A;return this[z](y)}})
});e.hook=function(q){var p=q.split(" ");l(p,function(r,s){o.cssHooks[s]={set:function(w,x){var u,v,t="";if(x!=="transparent"&&(o.type(x)!=="string"||(u=f(x)))){x=e(u||x);
if(!m.rgba&&x._rgba[3]!==1){v=s==="backgroundColor"?w.parentNode:w;while((t===""||t==="transparent")&&v&&v.style){try{t=o.css(v,"backgroundColor");v=v.parentNode
}catch(y){}}x=x.blend(t&&t!=="transparent"?t:"_default")}x=x.toRgbaString()}try{w.style[s]=x}catch(y){}}};o.fx.step[s]=function(t){if(!t.colorInit){t.start=e(t.elem,s);
t.end=e(t.end);t.colorInit=true}o.cssHooks[s].set(t.elem,t.start.transition(t.end,t.pos))}})};e.hook(k);o.cssHooks.borderColor={expand:function(q){var p={};
l(["Top","Right","Bottom","Left"],function(s,r){p["border"+r+"Color"]=q});return p}};a=o.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}
}(jQuery));/*! rangeslider.js - v0.3.6 | (c) 2014 @andreruffert | MIT license | https://github.com/andreruffert/rangeslider.js */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)
}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}}(function(f){function a(){var n=document.createElement("input");n.setAttribute("type","range");
return n.type!=="text"}var h="rangeslider",i=[],l=0,c=a(),e={polyfill:true,rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]};
function g(o,p){var n=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return o.apply(null,n)},p)}function k(o,n){n=n||100;return function(){if(!o.debouncing){var p=Array.prototype.slice.apply(arguments);
o.lastReturnVal=o.apply(window,p);o.debouncing=true}clearTimeout(o.debounceTimeout);o.debounceTimeout=setTimeout(function(){o.debouncing=false},n);return o.lastReturnVal
}}function b(n){if(n.offsetWidth!==0||n.offsetHeight!==0){return false}return true}function d(o){var n=[],p=o.parentNode;while(b(p)){n.push(p);p=p.parentNode
}return n}function m(s,r){var n=d(s),t=n.length,o=[],u=s[r];if(t){for(var q=0;q<t;q++){o[q]=n[q].style.display;n[q].style.display="block";n[q].style.height="0";
n[q].style.overflow="hidden";n[q].style.visibility="hidden"}u=s[r];for(var p=0;p<t;p++){n[p].style.display=o[p];n[p].style.height="";n[p].style.overflow="";
n[p].style.visibility=""}}return u}function j(o,n){this.$window=f(window);this.$document=f(document);this.$element=f(o);this.options=f.extend({},e,n);this._defaults=e;
this._name=h;this.startEvent=this.options.startEvent.join("."+h+" ")+"."+h;this.moveEvent=this.options.moveEvent.join("."+h+" ")+"."+h;this.endEvent=this.options.endEvent.join("."+h+" ")+"."+h;
this.polyfill=this.options.polyfill;this.onInit=this.options.onInit;this.onSlide=this.options.onSlide;this.onSlideEnd=this.options.onSlideEnd;if(this.polyfill){if(c){return false
}}this.identifier="js-"+h+"-"+(l++);this.min=parseFloat(this.$element[0].getAttribute("min")||0);this.max=parseFloat(this.$element[0].getAttribute("max")||100);
this.value=parseFloat(this.$element[0].value||this.min+(this.max-this.min)/2);this.step=parseFloat(this.$element[0].getAttribute("step")||1);this.$fill=f('<div class="'+this.options.fillClass+'" />');
this.$handle=f('<div class="'+this.options.handleClass+'" />');this.$range=f('<div class="'+this.options.rangeClass+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle);
this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"});this.handleDown=f.proxy(this.handleDown,this);this.handleMove=f.proxy(this.handleMove,this);
this.handleEnd=f.proxy(this.handleEnd,this);this.init();var p=this;this.$window.on("resize."+h,k(function(){g(function(){p.update()},300)},20));this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown);
this.$element.on("change."+h,function(s,r){if(r&&r.origin===h){return}var q=s.target.value,t=p.getPositionFromValue(q);p.setPosition(t)})}j.prototype.init=function(){if(this.onInit&&typeof this.onInit==="function"){this.onInit()
}this.update()};j.prototype.update=function(){this.handleWidth=m(this.$handle[0],"offsetWidth");this.rangeWidth=m(this.$range[0],"offsetWidth");this.maxHandleX=this.rangeWidth-this.handleWidth;
this.grabX=this.handleWidth/2;this.position=this.getPositionFromValue(this.value);if(this.$element[0].disabled){this.$range.addClass(this.options.disabledClass)
}else{this.$range.removeClass(this.options.disabledClass)}this.setPosition(this.position)};j.prototype.handleDown=function(o){o.preventDefault();this.$document.on(this.moveEvent,this.handleMove);
this.$document.on(this.endEvent,this.handleEnd);if((" "+o.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass)>-1){return}var q=this.getRelativePosition(o),n=this.$range[0].getBoundingClientRect().left,p=this.getPositionFromNode(this.$handle[0])-n;
this.setPosition(q-this.grabX);if(q>=p&&q<p+this.handleWidth){this.grabX=q-p}};j.prototype.handleMove=function(n){n.preventDefault();var o=this.getRelativePosition(n);
this.setPosition(o-this.grabX)};j.prototype.handleEnd=function(n){n.preventDefault();this.$document.off(this.moveEvent,this.handleMove);this.$document.off(this.endEvent,this.handleEnd);
if(this.onSlideEnd&&typeof this.onSlideEnd==="function"){this.onSlideEnd(this.position,this.value)}};j.prototype.cap=function(p,o,n){if(p<o){return o}if(p>n){return n
}return p};j.prototype.setPosition=function(p){var n,o;n=(this.getValueFromPosition(this.cap(p,0,this.maxHandleX))/this.step)*this.step;o=this.getPositionFromValue(n);
this.$fill[0].style.width=(o+this.grabX)+"px";this.$handle[0].style.left=o+"px";this.setValue(n);this.position=o;this.value=n;if(this.onSlide&&typeof this.onSlide==="function"){this.onSlide(o,n)
}};j.prototype.getPositionFromNode=function(o){var n=0;while(o!==null){n+=o.offsetLeft;o=o.offsetParent}return n};j.prototype.getRelativePosition=function(p){var o=this.$range[0].getBoundingClientRect().left,n=0;
if(typeof p.pageX!=="undefined"){n=p.pageX}else{if(typeof p.originalEvent.clientX!=="undefined"){n=p.originalEvent.clientX}else{if(p.originalEvent.touches&&p.originalEvent.touches[0]&&typeof p.originalEvent.touches[0].clientX!=="undefined"){n=p.originalEvent.touches[0].clientX
}else{if(p.currentPoint&&typeof p.currentPoint.x!=="undefined"){n=p.currentPoint.x}}}}return n-o};j.prototype.getPositionFromValue=function(o){var n,p;
n=(o-this.min)/(this.max-this.min);p=n*this.maxHandleX;return p};j.prototype.getValueFromPosition=function(p){var n,o;n=((p)/(this.maxHandleX||1));o=this.step*Math.round(n*(this.max-this.min)/this.step)+this.min;
return Number((o).toFixed(2))};j.prototype.setValue=function(n){if(n!==this.value){this.$element.val(n).trigger("change",{origin:h})}};j.prototype.destroy=function(){this.$document.off(this.startEvent,"#"+this.identifier,this.handleDown);
this.$element.off("."+h).removeAttr("style").removeData("plugin_"+h);if(this.$range&&this.$range.length){this.$range[0].parentNode.removeChild(this.$range[0])
}i.splice(i.indexOf(this.$element[0]),1);if(!i.length){this.$window.off("."+h)}};f.fn[h]=function(n){return this.each(function(){var p=f(this),o=p.data("plugin_"+h);
if(!o){p.data("plugin_"+h,(o=new j(this,n)));i.push(this)}if(typeof n==="string"){o[n]()}})}}));